<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Velocity Private Speed Test</title>
<style>
body{font-family:'Orbitron',sans-serif; background:#0b1120; color:white; text-align:center; margin:0; padding:0;}
button{padding:10px 20px; margin:10px; border-radius:10px; cursor:pointer; background:#0ff; border:none; color:#000;}
.progress{width:80%; height:20px; background:#222; margin:10px auto; border-radius:10px; overflow:hidden;}
.fill{height:100%; width:0%; background:#0ff; transition:width 0.3s;}
.stat-box{background:rgba(0,0,0,0.5); padding:15px; margin:5px; border-radius:10px;}
#pulse{width:200px;height:200px;margin:20px auto;border-radius:50%;background:linear-gradient(45deg,#0ff,#00f);display:flex;align-items:center;justify-content:center;box-shadow:0 0 20px #0ff;}
</style>
</head>
<body>

<h1>ðŸš€ Velocity Private Speed Test</h1>

<div id="pulse">
<button id="startBtn">Start Test</button>
</div>

<div class="flex-container">
<div id="pingBox" class="stat-box">Ping: -- ms | Jitter: -- ms</div>
<div id="downloadBox" class="stat-box">Download: -- Mbps</div>
<div id="uploadBox" class="stat-box">Upload: -- Mbps</div>
</div>

<div class="progress"><div id="pingProgress" class="fill"></div></div>
<div class="progress"><div id="downloadProgress" class="fill"></div></div>
<div class="progress"><div id="uploadProgress" class="fill"></div></div>

<div>
<button id="shareBtn">ðŸ”— Share Result</button>
<div id="history"></div>
</div>

<script>
const startBtn=document.getElementById('startBtn');
const pingEl=document.getElementById('pingBox');
const downloadEl=document.getElementById('downloadBox');
const uploadEl=document.getElementById('uploadBox');
const pingProgress=document.getElementById('pingProgress');
const downloadProgress=document.getElementById('downloadProgress');
const uploadProgress=document.getElementById('uploadProgress');
const historyDiv=document.getElementById('history');

let historyData=JSON.parse(localStorage.getItem('speedTestHistory')||'[]');

function renderHistory(){
  if(historyData.length===0){historyDiv.innerHTML='<em>No history yet</em>'; return;}
  historyDiv.innerHTML=historyData.map(r=>`<div>${r.time}: Ping ${r.ping} ms | Download ${r.download} Mbps | Upload ${r.upload} Mbps</div>`).join('');
}
renderHistory();

// Simulated ping
async function measurePing(){
  pingProgress.style.width='0%';
  let ping=Math.random()*50+10; // simulate 10-60ms
  for(let i=0;i<=100;i+=20){ pingProgress.style.width=i+'%'; await new Promise(r=>setTimeout(r,20)); }
  pingEl.textContent=`Ping: ${ping.toFixed(1)} ms | Jitter: ${(Math.random()*5).toFixed(1)} ms`;
  return ping;
}

// Simulated download
async function measureDownload(){
  downloadProgress.style.width='0%';
  let mbps=Math.random()*80+20; // simulate 20-100Mbps
  for(let i=0;i<=100;i+=20){ downloadProgress.style.width=i+'%'; await new Promise(r=>setTimeout(r,50)); }
  downloadEl.textContent=`Download: ${mbps.toFixed(1)} Mbps`;
  return mbps;
}

// Simulated upload
async function measureUpload(){
  uploadProgress.style.width='0%';
  let mbps=Math.random()*40+5; // simulate 5-45Mbps
  for(let i=0;i<=100;i+=20){ uploadProgress.style.width=i+'%'; await new Promise(r=>setTimeout(r,50)); }
  uploadEl.textContent=`Upload: ${mbps.toFixed(1)} Mbps`;
  return mbps;
}

startBtn.addEventListener('click', async ()=>{
  startBtn.disabled=true;
  pingProgress.style.width=downloadProgress.style.width=uploadProgress.style.width='0%';
  const ping=await measurePing();
  const download=await measureDownload();
  const upload=await measureUpload();
  historyData.unshift({time:new Date().toLocaleString(), ping, download, upload});
  if(historyData.length>10) historyData.pop();
  localStorage.setItem('speedTestHistory', JSON.stringify(historyData));
  renderHistory();
  startBtn.disabled=false;
});

// Share
document.getElementById('shareBtn').addEventListener('click', ()=>{
  if(historyData.length===0) return alert('No result to share');
  const latest=historyData[0];
  const text=`My Internet Speed: Download ${latest.download} Mbps, Upload ${latest.upload} Mbps, Ping ${latest.ping} ms`;
  if(navigator.share){ navigator.share({title:'My Speed Test', text}); }
  else{ navigator.clipboard.writeText(text).then(()=>alert('Copied to clipboard')); }
});
</script>
</body>
</html>
