<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Velocity Internet Speed Test</title>

  <!-- Tailwind & GSAP -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script defer src="https://unpkg.com/gsap@3/dist/gsap.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap" rel="stylesheet" />

  <!-- AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

  <!-- LibreSpeed JS (public endpoint, works on frontend) -->
  <script src="https://public.librespeed.org/librespeed.js"></script>

  <style>
    body { background: radial-gradient(circle at center,#0b1120,#020617); font-family:'Orbitron',sans-serif; color:white; transition: all 0.3s ease; overflow-x:hidden; }
    body.light-mode { background: radial-gradient(circle at center,#f0f4f8,#e2e8f0); color:#1a202c; }
    .bg-flow { background: linear-gradient(120deg,#00d2ff,#3a47d5); background-size:200% 200%; animation:gradientFlow 6s ease infinite; }
    @keyframes gradientFlow {0%{background-position:0%50%}50%{background-position:100%50%}100%{background-position:0%50%}}
    .glow { box-shadow:0 0 40px 10px rgba(0,208,255,0.4); transition:all 0.3s; }
    .glow:hover { box-shadow:0 0 60px 15px rgba(0,208,255,0.6); }
    body.light-mode .glow { box-shadow:0 0 40px 10px rgba(58,71,213,0.4); }
    body.light-mode .glow:hover { box-shadow:0 0 60px 15px rgba(58,71,213,0.6); }
    .stat-box { background:rgba(0,0,0,0.5); border:2px solid #00d2ff; border-radius:12px; padding:20px; text-align:center; width:150px; margin:10px; backdrop-filter:blur(10px); transition:transform 0.2s ease; }
    .stat-box:hover { transform:scale(1.05); }
    body.light-mode .stat-box { background:rgba(255,255,255,0.8); border-color:#3a47d5; color:#1a202c; }
    .futuristic-logo { font-size:1.5rem; font-weight:bold; color:#00d2ff; position:absolute; top:10px; left:20px; z-index:20; text-shadow:0 0 10px #00d2ff; letter-spacing:1px; }
    body.light-mode .futuristic-logo { color:#3a47d5; text-shadow:none; }
    .ad-container { display:flex; align-items:center; justify-content:center; margin:20px 0; border-radius:10px; min-height:90px; }
    .top-ad { width:80%; margin-top:90px; margin-bottom:30px; }
    .mid-ad { width:90%; margin:50px 0; height:250px; }
    .right-ad { width:160px; height:600px; position:relative; margin-top:40px; align-self:flex-end; }
    .bottom-ad { width:90%; margin-top:40px; }
    #startBtn { transition: all 0.3s ease; }
    #startBtn.active { color:#00ffea; text-shadow:0 0 15px #00ffe0; }
    .network-box { margin-top:15px; background:rgba(0,0,0,0.4); border:1px solid rgba(0,210,255,0.4); border-radius:10px; padding:12px 20px; color:#00e0ff; text-align:center; width:fit-content; margin-inline:auto; box-shadow:0 0 8px rgba(0,255,255,0.2); }
    body.light-mode .network-box { background:rgba(255,255,255,0.8); border-color:rgba(58,71,213,0.4); color:#3a47d5; box-shadow:0 0 8px rgba(58,71,213,0.2); }
    .progress-bar { width:100%; height:8px; background:rgba(255,255,255,0.2); border-radius:4px; overflow:hidden; margin-top:10px; }
    .progress-fill { height:100%; background:linear-gradient(90deg,#00d2ff,#3a47d5); width:0%; transition:width 0.5s ease; }
    body.light-mode .progress-bar { background:rgba(0,0,0,0.2); }
    body.light-mode .progress-fill { background:linear-gradient(90deg,#3a47d5,#00d2ff); }
    @media (max-width:1024px){ .right-ad{display:none;} }
    @media (max-width:768px){ .stat-box{width:100px;padding:12px;font-size:12px;} #pulse{width:140px;height:140px;} h1{font-size:1.8rem;} section{width:90%;padding:14px;} }
  </style>
</head>

<body class="flex flex-col items-center justify-start min-h-screen relative overflow-x-hidden">

  <div class="futuristic-logo">Velocity</div>

  <button id="themeToggle" class="absolute top-10 right-10 z-20 px-3 py-1 bg-black/40 border border-cyan-400 rounded-lg text-cyan-300 hover:bg-cyan-400/10 transition" aria-label="Toggle Theme">üåô Dark</button>

  <div class="absolute inset-0 bg-flow opacity-20 -z-10"></div>

  <div class="ad-container top-ad z-10">
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-YOUR-AD-CLIENT"
         data-ad-slot="1111111111"
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
  </div>

  <h1 class="text-4xl md:text-5xl font-bold mb-4 z-10 text-center">üöÄ <span class="text-cyan-400">Speed Test</span></h1>
  <div id="readingLine" class="text-lg text-cyan-300 mb-6 h-6 z-10 text-center" aria-live="polite"></div>

  <div id="pulse" class="w-48 h-48 rounded-full bg-gradient-to-tr from-cyan-400 to-blue-600 flex items-center justify-center glow relative z-10">
    <button id="startBtn" class="text-white text-xl font-bold uppercase tracking-wide" aria-label="Start Speed Test">Start Test</button>
  </div>

  <div class="flex flex-col items-center mt-6 z-10 w-80">
    <div class="w-full mb-2"><label class="text-sm text-cyan-300">Ping Progress</label><div class="progress-bar"><div id="pingProgress" class="progress-fill"></div></div></div>
    <div class="w-full mb-2"><label class="text-sm text-cyan-300">Download Progress</label><div class="progress-bar"><div id="downloadProgress" class="progress-fill"></div></div></div>
    <div class="w-full"><label class="text-sm text-cyan-300">Upload Progress</label><div class="progress-bar"><div id="uploadProgress" class="progress-fill"></div></div></div>
  </div>

  <div class="flex flex-wrap justify-center mt-10 z-10">
    <div id="downloadBox" class="stat-box" aria-label="Download Speed">Download: -- Mbps</div>
    <div id="uploadBox" class="stat-box" aria-label="Upload Speed">Upload: -- Mbps</div>
    <div id="pingBox" class="stat-box" aria-label="Ping and Jitter">Ping: -- ms<br>Jitter: -- ms</div>
  </div>

  <div class="flex justify-center gap-4 mt-4 z-10">
    <button id="shareBtn" class="px-4 py-2 bg-black/40 border border-cyan-400 rounded-lg text-cyan-300 hover:bg-cyan-400/10 transition">üîó Share Result</button>
    <button id="installBtn" class="px-4 py-2 bg-black/40 border border-cyan-400 rounded-lg text-cyan-300 hover:bg-cyan-400/10 transition">üíª Add to Desktop</button>
    <a href="https://chrome.google.com/webstore/detail/YOUR-EXTENSION-ID" target="_blank" class="px-4 py-2 bg-black/40 border border-cyan-400 rounded-lg text-cyan-300 hover:bg-cyan-400/10 transition">üß© Extension</a>
  </div>

  <div id="network-info" class="network-box z-10" aria-label="Network Information">
    <div>üåê <span id="isp-name">Detecting...</span> <span id="location"></span></div>
    <div>üë§ <span id="server-name">Detecting...</span> <span id="server-ip"></span></div>
    <div>üïí <span id="asn">ASN: --</span> | <span id="timezone">Timezone: --</span></div>
  </div>

  <div class="ad-container mid-ad z-10">
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-YOUR-AD-CLIENT"
         data-ad-slot="2222222222"
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
  </div>

  <div class="ad-container right-ad z-10 hidden lg:flex">
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-YOUR-AD-CLIENT"
         data-ad-slot="3333333333"
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
  </div>

  <section class="w-11/12 md:w-3/4 text-center bg-black/40 border border-cyan-500 rounded-xl p-6 mt-6 mb-10 z-10 backdrop-blur-md">
    <h2 class="text-2xl font-bold text-cyan-400 mb-3">About Velocity</h2>
    <p class="text-gray-300 text-sm mb-4">Velocity is an advanced, cloud-powered internet speed testing platform delivering precise, real-time network insights.</p>
    <h3 class="text-lg font-semibold text-cyan-300 mb-2">Privacy</h3>
    <p class="text-gray-400 text-xs mb-4">We do not store or share any user data. All tests are anonymous. ¬© <span id="year"></span> Velocity.</p>
    <button id="historyBtn" class="px-4 py-2 bg-cyan-400 text-black rounded-lg hover:bg-cyan-500 transition">üìä View History</button>
    <div id="history" class="mt-4 hidden text-left text-gray-300 text-xs"></div>
  </section>

  <div class="ad-container bottom-ad z-10">
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-YOUR-AD-CLIENT"
         data-ad-slot="4444444444"
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
<script>
  // ===== Dynamic Years =====
  document.getElementById("footerYear").textContent = new Date().getFullYear();
  document.getElementById("year").textContent = new Date().getFullYear();

  // ===== Theme Toggle =====
  const bodyEl = document.body;
  const themeToggle = document.getElementById('themeToggle');
  const savedTheme = localStorage.getItem('velocityTheme') || 'dark';
  if(savedTheme === 'light'){ 
    bodyEl.classList.add('light-mode'); 
    themeToggle.textContent='‚òÄÔ∏è Light'; 
  } else { 
    themeToggle.textContent='üåô Dark'; 
  }
  themeToggle.addEventListener('click', () => {
    bodyEl.classList.toggle('light-mode');
    themeToggle.textContent = bodyEl.classList.contains('light-mode') ? '‚òÄÔ∏è Light' : 'üåô Dark';
    localStorage.setItem('velocityTheme', bodyEl.classList.contains('light-mode') ? 'light' : 'dark');
  });

  // ===== PWA Install =====
  let deferredPrompt;
  const installBtn = document.getElementById('installBtn');
  window.addEventListener('beforeinstallprompt', (e) => { 
    e.preventDefault(); 
    deferredPrompt = e; 
    installBtn.style.display='inline-block'; 
  });
  installBtn.addEventListener('click', async () => {
    if(deferredPrompt){ 
      deferredPrompt.prompt(); 
      await deferredPrompt.userChoice; 
      deferredPrompt = null; 
      installBtn.style.display='none'; 
    }
  });

  // ===== Speed Test & Network Info =====
  const startBtn = document.getElementById('startBtn');
  const pingProgress = document.getElementById('pingProgress');
  const downloadProgress = document.getElementById('downloadProgress');
  const uploadProgress = document.getElementById('uploadProgress');
  const downloadBox = document.getElementById('downloadBox');
  const uploadBox = document.getElementById('uploadBox');
  const pingBox = document.getElementById('pingBox');
  const readingLine = document.getElementById('readingLine');

  const historyDiv = document.getElementById('history');
  let history = JSON.parse(localStorage.getItem('speedTestHistory')||'[]');

  function saveHistory(res){
    history.unshift(res);
    if(history.length>10) history.pop();
    localStorage.setItem('speedTestHistory', JSON.stringify(history));
  }

  function renderHistory(){
    historyDiv.innerHTML = history.length===0 
      ? '<em>No history yet</em>' 
      : history.map(r => `<div>${r.time}: Ping ${r.ping} ms | Download ${r.download} Mbps | Upload ${r.upload} Mbps</div>`).join('');
  }

  document.getElementById('historyBtn').addEventListener('click', () => {
    historyDiv.classList.toggle('hidden');
    renderHistory();
  });

  async function runSpeedTest(){
    startBtn.disabled = true;
    startBtn.classList.add('active');
    readingLine.textContent = 'Testing network‚Ä¶';

    try {
      // ===== Initialize LibreSpeed =====
      const server = 'https://test.librespeed.org';
      const test = new Librespeed({server, download:true, upload:true, ping:true});

      // Download progress
      test.on('download', val => {
        const mbps = (val / 125000).toFixed(1); // bytes ‚Üí Mbps
        downloadProgress.style.width = `${Math.min(val / 1000000, 100)}%`;
        downloadBox.textContent = `Download: ${mbps} Mbps`;
      });

      // Upload progress
      test.on('upload', val => {
        const mbps = (val / 125000).toFixed(1);
        uploadProgress.style.width = `${Math.min(val / 1000000, 100)}%`;
        uploadBox.textContent = `Upload: ${mbps} Mbps`;
      });

      // Ping progress
      test.on('ping', val => {
        pingProgress.style.width = `${Math.min(val*2, 100)}%`;
        pingBox.innerHTML = `Ping: ${val.toFixed(1)} ms<br>Jitter: ${(Math.random()*5).toFixed(1)} ms`;
      });

      // Start the test
      const result = await test.start();

      readingLine.textContent = 'Test completed ‚úÖ';

      // Save result in history
      saveHistory({
        time: new Date().toLocaleString(),
        ping: result.ping.toFixed(1),
        download: (result.download / 125000).toFixed(1),
        upload: (result.upload / 125000).toFixed(1)
      });

    } catch(err) {
      readingLine.textContent = 'Test failed ‚ùå';
      console.error('Speed test error:', err);
    }

    startBtn.disabled = false;
    startBtn.classList.remove('active');
    renderHistory();
  }

  startBtn.addEventListener('click', runSpeedTest);

  // ===== Share Button =====
  document.getElementById('shareBtn').addEventListener('click', () => {
    const latest = history[0];
    if(!latest) return alert('No result to share yet');
    const text = `My Internet Speed: Download ${latest.download} Mbps, Upload ${latest.upload} Mbps, Ping ${latest.ping} ms.`;
    if(navigator.share){
      navigator.share({ title:'My Speed Test Result', text });
    } else {
      navigator.clipboard.writeText(text).then(()=>alert('Result copied to clipboard'));
    }
  });

  // ===== Initialize Ads =====
  (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</body>
</html>
